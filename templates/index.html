
<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-50">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sparky – Your Mental Wellness Buddy</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="h-full">
  <div class="min-h-full flex flex-col">
    <header class="bg-indigo-600 text-white p-6 text-center">
      <h1 class="text-4xl font-bold">Sparky ✨</h1>
      <p class="text-xl mt-2">Your 24×7 Mental Wellness Buddy for Students</p>
    </header>

    <div id="chat-container" class="flex-1 max-w-4xl mx-auto w-full p-6 flex flex-col">
      <div id="messages" class="flex-1 overflow-y-auto mb-4 space-y-4 bg-white rounded-lg shadow p-6"></div>
      
      <div class="flex gap-3">
        <input type="text" id="user-input" placeholder="Type your message here..." 
               class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"/>
        <button id="send-btn" class="px-8 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition">
          Send
        </button>
      </div>
    </div>
  </div>

  <script>
    const messagesDiv = document.getElementById('messages');
    const input = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');

    function addMessage(text, isUser = false) {
      const div = document.createElement('div');
      div.className = isUser ? 'text-right' : 'text-left';
      div.innerHTML = `<div class="${isUser ? 'bg-indigo-600 text-white' : 'bg-gray-200'} inline-block rounded-lg px-5 py-3 max-w-xs lg:max-w-md">
        ${text.replace(/\n/g, '<br>')}
      </div>`;
      messagesDiv.appendChild(div);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    async function sendMessage() {
      const msg = input.value.trim();
      if (!msg) return;
      addMessage(msg, true);
      input.value = '';
      sendBtn.disabled = true;

      const res = await fetch('/chat', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({message: msg})
      });
      const data = await res.json();
      addMessage(data.response);
      sendBtn.disabled = false;
      input.focus();
    }

    sendBtn.onclick = sendMessage;
    input.onkeypress = e => e.key === 'Enter' && sendMessage();
    
    // Welcome message
    addMessage("Namaste! I'm Sparky, your mental wellness buddy ❤️<br>How are you feeling today?");
  </script>
</body>
</html>
